{"ast":null,"code":"import _objectSpread from\"/workspace/BigGrade-Main-files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import firebaseClient from\"../firebase/firebaseClient\";import{useQuery,useMutation,useQueryClient}from\"@tanstack/react-query\";import{Plus,MessageSquare}from\"lucide-react\";import MegathreadCard from\"../../components/megathreads/megathreadCard\";import CreateMegathreadForm from\"../../components/megathreads/CreateMegathreadForm\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function StudentsDashboard(){const[showCreateForm,setShowCreateForm]=useState(false);const[filter,setFilter]=useState(\"all\");const queryClient=useQueryClient();// Get current user\nconst{data:user}=useQuery({queryKey:['currentUser'],queryFn:async()=>{return new Promise(resolve=>{const unsubscribe=firebaseClient.auth.onAuthStateChanged(user=>{unsubscribe();resolve(user);});});},staleTime:Infinity});// Get megathreads\nconst{data:megathreads,isLoading}=useQuery({queryKey:['studentMegathreads'],queryFn:()=>firebaseClient.entities.Megathread.filter({author_type:'student'},'-created_date',50),initialData:[]});// Create megathread mutation\nconst createMutation=useMutation({mutationFn:data=>firebaseClient.entities.Megathread.create(_objectSpread(_objectSpread({},data),{},{author_type:'student',author_name:(user===null||user===void 0?void 0:user.displayName)||'Student',author_email:(user===null||user===void 0?void 0:user.email)||'',author_avatar_url:(user===null||user===void 0?void 0:user.photoURL)||'',created_date:new Date().toISOString()})),onSuccess:()=>{queryClient.invalidateQueries(['studentMegathreads']);setShowCreateForm(false);}});if(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"md:flex md:items-center md:justify-between mb-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 min-w-0\",children:/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate\",children:\"Student Dashboard\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 flex md:mt-0 md:ml-4\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowCreateForm(true),className:\"ml-3 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\",children:[/*#__PURE__*/_jsx(Plus,{className:\"-ml-1 mr-2 h-5 w-5\"}),\"New Megathread\"]})})]}),showCreateForm&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-8\",children:/*#__PURE__*/_jsx(CreateMegathreadForm,{onSubmit:data=>createMutation.mutate(data),onCancel:()=>setShowCreateForm(false),isLoading:createMutation.isLoading})}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setFilter(\"all\"),className:\"px-3 py-2 rounded-md text-sm font-medium \".concat(filter===\"all\"?\"bg-indigo-100 text-indigo-800\":\"text-gray-500 hover:text-gray-700\"),children:\"All Threads\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setFilter(\"mine\"),className:\"px-3 py-2 rounded-md text-sm font-medium \".concat(filter===\"mine\"?\"bg-indigo-100 text-indigo-800\":\"text-gray-500 hover:text-gray-700\"),children:\"My Threads\"})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-6\",children:megathreads&&megathreads.length>0?megathreads.map(thread=>/*#__PURE__*/_jsx(MegathreadCard,{thread:thread},thread.id)):/*#__PURE__*/_jsxs(\"div\",{className:\"text-center py-12\",children:[/*#__PURE__*/_jsx(MessageSquare,{className:\"mx-auto h-12 w-12 text-gray-400\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mt-2 text-sm font-medium text-gray-900\",children:\"No megathreads\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-gray-500\",children:\"Get started by creating a new megathread.\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-6\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setShowCreateForm(true),className:\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\",children:[/*#__PURE__*/_jsx(Plus,{className:\"-ml-1 mr-2 h-5 w-5\"}),\"New Megathread\"]})})]})})]});}","map":{"version":3,"names":["React","useState","firebaseClient","useQuery","useMutation","useQueryClient","Plus","MessageSquare","MegathreadCard","CreateMegathreadForm","jsx","_jsx","jsxs","_jsxs","StudentsDashboard","showCreateForm","setShowCreateForm","filter","setFilter","queryClient","data","user","queryKey","queryFn","Promise","resolve","unsubscribe","auth","onAuthStateChanged","staleTime","Infinity","megathreads","isLoading","entities","Megathread","author_type","initialData","createMutation","mutationFn","create","_objectSpread","author_name","displayName","author_email","email","author_avatar_url","photoURL","created_date","Date","toISOString","onSuccess","invalidateQueries","className","children","onClick","onSubmit","mutate","onCancel","concat","length","map","thread","id"],"sources":["/workspace/BigGrade-Main-files/src/pages/StudentDashboard.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport firebaseClient from \"../firebase/firebaseClient\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Plus, MessageSquare } from \"lucide-react\";\nimport MegathreadCard from \"../../components/megathreads/megathreadCard\";\nimport CreateMegathreadForm from \"../../components/megathreads/CreateMegathreadForm\";\n\nexport default function StudentsDashboard() {\n  const [showCreateForm, setShowCreateForm] = useState(false);\n  const [filter, setFilter] = useState(\"all\");\n  const queryClient = useQueryClient();\n\n  // Get current user\n  const { data: user } = useQuery({\n    queryKey: ['currentUser'],\n    queryFn: async () => {\n      return new Promise((resolve) => {\n        const unsubscribe = firebaseClient.auth.onAuthStateChanged((user) => {\n          unsubscribe();\n          resolve(user);\n        });\n      });\n    },\n    staleTime: Infinity,\n  });\n\n  // Get megathreads\n  const { data: megathreads, isLoading } = useQuery({\n    queryKey: ['studentMegathreads'],\n    queryFn: () => firebaseClient.entities.Megathread.filter({ author_type: 'student' }, '-created_date', 50),\n    initialData: [],\n  });\n\n  // Create megathread mutation\n  const createMutation = useMutation({\n    mutationFn: (data) => firebaseClient.entities.Megathread.create({\n      ...data,\n      author_type: 'student',\n      author_name: user?.displayName || 'Student',\n      author_email: user?.email || '',\n      author_avatar_url: user?.photoURL || '',\n      created_date: new Date().toISOString()\n    }),\n    onSuccess: () => {\n      queryClient.invalidateQueries(['studentMegathreads']);\n      setShowCreateForm(false);\n    },\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto\">\n      <div className=\"md:flex md:items-center md:justify-between mb-6\">\n        <div className=\"flex-1 min-w-0\">\n          <h2 className=\"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate\">\n            Student Dashboard\n          </h2>\n        </div>\n        <div className=\"mt-4 flex md:mt-0 md:ml-4\">\n          <button\n            onClick={() => setShowCreateForm(true)}\n            className=\"ml-3 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n          >\n            <Plus className=\"-ml-1 mr-2 h-5 w-5\" />\n            New Megathread\n          </button>\n        </div>\n      </div>\n\n      {showCreateForm && (\n        <div className=\"mb-8\">\n          <CreateMegathreadForm\n            onSubmit={(data) => createMutation.mutate(data)}\n            onCancel={() => setShowCreateForm(false)}\n            isLoading={createMutation.isLoading}\n          />\n        </div>\n      )}\n\n      <div className=\"mb-6\">\n        <div className=\"flex space-x-4\">\n          <button\n            onClick={() => setFilter(\"all\")}\n            className={`px-3 py-2 rounded-md text-sm font-medium ${\n              filter === \"all\"\n                ? \"bg-indigo-100 text-indigo-800\"\n                : \"text-gray-500 hover:text-gray-700\"\n            }`}\n          >\n            All Threads\n          </button>\n          <button\n            onClick={() => setFilter(\"mine\")}\n            className={`px-3 py-2 rounded-md text-sm font-medium ${\n              filter === \"mine\"\n                ? \"bg-indigo-100 text-indigo-800\"\n                : \"text-gray-500 hover:text-gray-700\"\n            }`}\n          >\n            My Threads\n          </button>\n        </div>\n      </div>\n\n      <div className=\"space-y-6\">\n        {megathreads && megathreads.length > 0 ? (\n          megathreads.map((thread) => (\n            <MegathreadCard key={thread.id} thread={thread} />\n          ))\n        ) : (\n          <div className=\"text-center py-12\">\n            <MessageSquare className=\"mx-auto h-12 w-12 text-gray-400\" />\n            <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No megathreads</h3>\n            <p className=\"mt-1 text-sm text-gray-500\">\n              Get started by creating a new megathread.\n            </p>\n            <div className=\"mt-6\">\n              <button\n                onClick={() => setShowCreateForm(true)}\n                className=\"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n              >\n                <Plus className=\"-ml-1 mr-2 h-5 w-5\" />\n                New Megathread\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}