{"ast":null,"code":"import _objectSpread from\"/workspace/BigGrade-Main-files/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from\"react\";import firebaseClient from\"@/firebase/firebaseClient\";import{useQuery,useMutation,useQueryClient}from\"@tanstack/react-query\";import{ArrowLeft,Send,User,MessageSquare}from\"lucide-react\";import{Link,useNavigate,useLocation}from\"react-router-dom\";import{createPageUrl}from\"@/utils\";import{format}from\"date-fns\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function MegathreadView(){const location=useLocation();const navigate=useNavigate();const urlParams=new URLSearchParams(location.search);const threadId=urlParams.get('id');const[replyContent,setReplyContent]=useState(\"\");const repliesEndRef=useRef(null);const queryClient=useQueryClient();const[replies,setReplies]=useState([]);const{data:user}=useQuery({queryKey:['currentUser'],queryFn:async()=>{return new Promise(resolve=>{const unsubscribe=firebaseClient.auth.onAuthStateChanged(user=>{unsubscribe();resolve(user);});});},staleTime:Infinity});// Get megathread data\nconst{data:thread,isLoading:threadLoading}=useQuery({queryKey:['megathread',threadId],queryFn:()=>firebaseClient.entities.Megathread.get(threadId),enabled:!!threadId});// Subscribe to replies\nuseEffect(()=>{if(!threadId)return;const unsubscribe=firebaseClient.entities.ThreadReply.subscribe({megathread_id:threadId},repliesData=>{setReplies(repliesData);});// Cleanup subscription on unmount\nreturn()=>unsubscribe();},[threadId]);// Scroll to bottom when replies change\nuseEffect(()=>{var _repliesEndRef$curren;(_repliesEndRef$curren=repliesEndRef.current)===null||_repliesEndRef$curren===void 0?void 0:_repliesEndRef$curren.scrollIntoView({behavior:\"smooth\"});},[replies]);const createReplyMutation=useMutation({mutationFn:newReply=>firebaseClient.entities.ThreadReply.create(_objectSpread(_objectSpread({},newReply),{},{megathread_id:threadId,author_name:(user===null||user===void 0?void 0:user.displayName)||'Anonymous',author_email:(user===null||user===void 0?void 0:user.email)||'',author_avatar_url:(user===null||user===void 0?void 0:user.photoURL)||'',created_date:new Date().toISOString()})),onSuccess:()=>{queryClient.invalidateQueries(['threadReplies',threadId]);setReplyContent(\"\");}});const handleReplySubmit=e=>{e.preventDefault();if(!replyContent.trim())return;createReplyMutation.mutate({content:replyContent});};if(!threadId){return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto px-4 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 mb-4\",children:\"Megathread not found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"Please select a valid megathread to view.\"}),/*#__PURE__*/_jsx(Link,{to:createPageUrl(\"MegathreadView\"),className:\"text-indigo-600 hover:text-indigo-800 font-medium\",children:\"\\u2190 Back to Megathreads\"})]})});}if(threadLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"})});}if(!thread){return/*#__PURE__*/_jsx(\"div\",{className:\"max-w-4xl mx-auto px-4 py-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold text-gray-900 mb-4\",children:\"Megathread not found\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 mb-4\",children:\"The requested megathread could not be found.\"}),/*#__PURE__*/_jsx(Link,{to:createPageUrl(\"MegathreadView\"),className:\"text-indigo-600 hover:text-indigo-800 font-medium\",children:\"\\u2190 Back to Megathreads\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto px-4 py-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsxs(Link,{to:createPageUrl(\"MegathreadView\"),className:\"flex items-center text-indigo-600 hover:text-indigo-800 font-medium\",children:[/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-5 w-5 mr-1\"}),\"Back to Megathreads\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 border-b border-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold text-gray-900\",children:thread.title}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800\",children:thread.author_type})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:thread.author_avatar_url?/*#__PURE__*/_jsx(\"img\",{className:\"h-10 w-10 rounded-full\",src:thread.author_avatar_url,alt:thread.author_name}):/*#__PURE__*/_jsx(\"div\",{className:\"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(User,{className:\"h-6 w-6 text-indigo-600\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900\",children:thread.author_name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:thread.created_date?format(new Date(thread.created_date),\"MMMM d, yyyy 'at' h:mm a\"):\"Unknown date\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"prose max-w-none\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-700\",children:thread.content})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white rounded-lg shadow\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-b border-gray-200\",children:/*#__PURE__*/_jsxs(\"h2\",{className:\"text-lg font-medium text-gray-900\",children:[\"Replies (\",replies.length,\")\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"divide-y divide-gray-200 max-h-96 overflow-y-auto\",children:[replies.length>0?replies.map(reply=>/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex-shrink-0\",children:reply.author_avatar_url?/*#__PURE__*/_jsx(\"img\",{className:\"h-10 w-10 rounded-full\",src:reply.author_avatar_url,alt:reply.author_name}):/*#__PURE__*/_jsx(\"div\",{className:\"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center\",children:/*#__PURE__*/_jsx(User,{className:\"h-6 w-6 text-indigo-600\"})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm font-medium text-gray-900\",children:reply.author_name}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:reply.created_date?format(new Date(reply.created_date),\"MMMM d, yyyy 'at' h:mm a\"):\"Unknown date\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-4 ml-13\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-700\",children:/*#__PURE__*/_jsx(\"p\",{children:reply.content})})})]},reply.id)):/*#__PURE__*/_jsxs(\"div\",{className:\"p-6 text-center\",children:[/*#__PURE__*/_jsx(MessageSquare,{className:\"mx-auto h-12 w-12 text-gray-400\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"mt-2 text-sm font-medium text-gray-900\",children:\"No replies yet\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-1 text-sm text-gray-500\",children:\"Be the first to reply to this megathread.\"})]}),/*#__PURE__*/_jsx(\"div\",{ref:repliesEndRef})]}),user&&/*#__PURE__*/_jsx(\"div\",{className:\"p-6 border-t border-gray-200\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleReplySubmit,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"reply\",className:\"block text-sm font-medium text-gray-700\",children:\"Add a reply\"}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-1\",children:/*#__PURE__*/_jsx(\"textarea\",{id:\"reply\",rows:3,className:\"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border border-gray-300 rounded-md p-2\",placeholder:\"Write your reply...\",value:replyContent,onChange:e=>setReplyContent(e.target.value)})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 flex justify-end\",children:/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",disabled:!replyContent.trim()||createReplyMutation.isLoading,className:\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50\",children:[/*#__PURE__*/_jsx(Send,{className:\"-ml-1 mr-2 h-5 w-5\"}),createReplyMutation.isLoading?\"Sending...\":\"Send\"]})})]})})]})]});}","map":{"version":3,"names":["React","useState","useRef","useEffect","firebaseClient","useQuery","useMutation","useQueryClient","ArrowLeft","Send","User","MessageSquare","Link","useNavigate","useLocation","createPageUrl","format","jsx","_jsx","jsxs","_jsxs","MegathreadView","location","navigate","urlParams","URLSearchParams","search","threadId","get","replyContent","setReplyContent","repliesEndRef","queryClient","replies","setReplies","data","user","queryKey","queryFn","Promise","resolve","unsubscribe","auth","onAuthStateChanged","staleTime","Infinity","thread","isLoading","threadLoading","entities","Megathread","enabled","ThreadReply","subscribe","megathread_id","repliesData","_repliesEndRef$curren","current","scrollIntoView","behavior","createReplyMutation","mutationFn","newReply","create","_objectSpread","author_name","displayName","author_email","email","author_avatar_url","photoURL","created_date","Date","toISOString","onSuccess","invalidateQueries","handleReplySubmit","e","preventDefault","trim","mutate","content","className","children","to","title","author_type","src","alt","length","map","reply","id","ref","onSubmit","htmlFor","rows","placeholder","value","onChange","target","type","disabled"],"sources":["/workspace/BigGrade-Main-files/src/pages/MegathreadView.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport firebaseClient from \"@/firebase/firebaseClient\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { ArrowLeft, Send, User, MessageSquare } from \"lucide-react\";\nimport { Link, useNavigate, useLocation } from \"react-router-dom\";\nimport { createPageUrl } from \"@/utils\";\nimport { format } from \"date-fns\";\n\nexport default function MegathreadView() {\n  const location = useLocation();\n  const navigate = useNavigate();\n  const urlParams = new URLSearchParams(location.search);\n  const threadId = urlParams.get('id');\n  const [replyContent, setReplyContent] = useState(\"\");\n  const repliesEndRef = useRef(null);\n  const queryClient = useQueryClient();\n  const [replies, setReplies] = useState([]);\n\n  const { data: user } = useQuery({\n    queryKey: ['currentUser'],\n    queryFn: async () => {\n      return new Promise((resolve) => {\n        const unsubscribe = firebaseClient.auth.onAuthStateChanged((user) => {\n          unsubscribe();\n          resolve(user);\n        });\n      });\n    },\n    staleTime: Infinity,\n  });\n\n  // Get megathread data\n  const { data: thread, isLoading: threadLoading } = useQuery({\n    queryKey: ['megathread', threadId],\n    queryFn: () => firebaseClient.entities.Megathread.get(threadId),\n    enabled: !!threadId,\n  });\n\n  // Subscribe to replies\n  useEffect(() => {\n    if (!threadId) return;\n\n    const unsubscribe = firebaseClient.entities.ThreadReply.subscribe(\n      { megathread_id: threadId },\n      (repliesData) => {\n        setReplies(repliesData);\n      }\n    );\n\n    // Cleanup subscription on unmount\n    return () => unsubscribe();\n  }, [threadId]);\n\n  // Scroll to bottom when replies change\n  useEffect(() => {\n    repliesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [replies]);\n\n  const createReplyMutation = useMutation({\n    mutationFn: (newReply) => firebaseClient.entities.ThreadReply.create({\n      ...newReply,\n      megathread_id: threadId,\n      author_name: user?.displayName || 'Anonymous',\n      author_email: user?.email || '',\n      author_avatar_url: user?.photoURL || '',\n      created_date: new Date().toISOString()\n    }),\n    onSuccess: () => {\n      queryClient.invalidateQueries(['threadReplies', threadId]);\n      setReplyContent(\"\");\n    },\n  });\n\n  const handleReplySubmit = (e) => {\n    e.preventDefault();\n    if (!replyContent.trim()) return;\n\n    createReplyMutation.mutate({\n      content: replyContent,\n    });\n  };\n\n  if (!threadId) {\n    return (\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h2 className=\"text-xl font-bold text-gray-900 mb-4\">Megathread not found</h2>\n          <p className=\"text-gray-600 mb-4\">Please select a valid megathread to view.</p>\n          <Link \n            to={createPageUrl(\"MegathreadView\")} \n            className=\"text-indigo-600 hover:text-indigo-800 font-medium\"\n          >\n            ← Back to Megathreads\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  if (threadLoading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600\"></div>\n      </div>\n    );\n  }\n\n  if (!thread) {\n    return (\n      <div className=\"max-w-4xl mx-auto px-4 py-8\">\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <h2 className=\"text-xl font-bold text-gray-900 mb-4\">Megathread not found</h2>\n          <p className=\"text-gray-600 mb-4\">The requested megathread could not be found.</p>\n          <Link \n            to={createPageUrl(\"MegathreadView\")} \n            className=\"text-indigo-600 hover:text-indigo-800 font-medium\"\n          >\n            ← Back to Megathreads\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-4xl mx-auto px-4 py-8\">\n      <div className=\"mb-6\">\n        <Link \n          to={createPageUrl(\"MegathreadView\")} \n          className=\"flex items-center text-indigo-600 hover:text-indigo-800 font-medium\"\n        >\n          <ArrowLeft className=\"h-5 w-5 mr-1\" />\n          Back to Megathreads\n        </Link>\n      </div>\n\n      <div className=\"bg-white rounded-lg shadow mb-6\">\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex justify-between items-start\">\n            <h1 className=\"text-2xl font-bold text-gray-900\">{thread.title}</h1>\n            <span className=\"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800\">\n              {thread.author_type}\n            </span>\n          </div>\n          <div className=\"mt-4 flex items-center\">\n            <div className=\"flex-shrink-0\">\n              {thread.author_avatar_url ? (\n                <img className=\"h-10 w-10 rounded-full\" src={thread.author_avatar_url} alt={thread.author_name} />\n              ) : (\n                <div className=\"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center\">\n                  <User className=\"h-6 w-6 text-indigo-600\" />\n                </div>\n              )}\n            </div>\n            <div className=\"ml-3\">\n              <p className=\"text-sm font-medium text-gray-900\">{thread.author_name}</p>\n              <p className=\"text-sm text-gray-500\">\n                {thread.created_date ? format(new Date(thread.created_date), \"MMMM d, yyyy 'at' h:mm a\") : \"Unknown date\"}\n              </p>\n            </div>\n          </div>\n        </div>\n        <div className=\"p-6\">\n          <div className=\"prose max-w-none\">\n            <p className=\"text-gray-700\">{thread.content}</p>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"bg-white rounded-lg shadow\">\n        <div className=\"p-6 border-b border-gray-200\">\n          <h2 className=\"text-lg font-medium text-gray-900\">\n            Replies ({replies.length})\n          </h2>\n        </div>\n        <div className=\"divide-y divide-gray-200 max-h-96 overflow-y-auto\">\n          {replies.length > 0 ? (\n            replies.map((reply) => (\n              <div key={reply.id} className=\"p-6\">\n                <div className=\"flex items-center\">\n                  <div className=\"flex-shrink-0\">\n                    {reply.author_avatar_url ? (\n                      <img className=\"h-10 w-10 rounded-full\" src={reply.author_avatar_url} alt={reply.author_name} />\n                    ) : (\n                      <div className=\"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center\">\n                        <User className=\"h-6 w-6 text-indigo-600\" />\n                      </div>\n                    )}\n                  </div>\n                  <div className=\"ml-3\">\n                    <p className=\"text-sm font-medium text-gray-900\">{reply.author_name}</p>\n                    <p className=\"text-sm text-gray-500\">\n                      {reply.created_date ? format(new Date(reply.created_date), \"MMMM d, yyyy 'at' h:mm a\") : \"Unknown date\"}\n                    </p>\n                  </div>\n                </div>\n                <div className=\"mt-4 ml-13\">\n                  <div className=\"text-gray-700\">\n                    <p>{reply.content}</p>\n                  </div>\n                </div>\n              </div>\n            ))\n          ) : (\n            <div className=\"p-6 text-center\">\n              <MessageSquare className=\"mx-auto h-12 w-12 text-gray-400\" />\n              <h3 className=\"mt-2 text-sm font-medium text-gray-900\">No replies yet</h3>\n              <p className=\"mt-1 text-sm text-gray-500\">\n                Be the first to reply to this megathread.\n              </p>\n            </div>\n          )}\n          <div ref={repliesEndRef} />\n        </div>\n\n        {user && (\n          <div className=\"p-6 border-t border-gray-200\">\n            <form onSubmit={handleReplySubmit}>\n              <div>\n                <label htmlFor=\"reply\" className=\"block text-sm font-medium text-gray-700\">\n                  Add a reply\n                </label>\n                <div className=\"mt-1\">\n                  <textarea\n                    id=\"reply\"\n                    rows={3}\n                    className=\"shadow-sm focus:ring-indigo-500 focus:border-indigo-500 block w-full sm:text-sm border border-gray-300 rounded-md p-2\"\n                    placeholder=\"Write your reply...\"\n                    value={replyContent}\n                    onChange={(e) => setReplyContent(e.target.value)}\n                  />\n                </div>\n              </div>\n              <div className=\"mt-3 flex justify-end\">\n                <button\n                  type=\"submit\"\n                  disabled={!replyContent.trim() || createReplyMutation.isLoading}\n                  className=\"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50\"\n                >\n                  <Send className=\"-ml-1 mr-2 h-5 w-5\" />\n                  {createReplyMutation.isLoading ? \"Sending...\" : \"Send\"}\n                </button>\n              </div>\n            </form>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}