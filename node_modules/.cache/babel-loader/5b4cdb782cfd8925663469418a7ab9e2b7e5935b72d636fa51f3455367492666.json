{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Link}from\"react-router-dom\";import{MessageCircle,User,Calendar,Clock}from\"lucide-react\";import{format}from\"date-fns\";import firebaseClient from\"@/firebase/firebaseClient\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function MegathreadCard(_ref){let{thread}=_ref;const[replyCount,setReplyCount]=useState(0);const[loading,setLoading]=useState(true);// Get reply count for this megathread\nuseEffect(()=>{if(!(thread!==null&&thread!==void 0&&thread.id))return;const unsubscribe=firebaseClient.entities.ThreadReply.subscribe({megathread_id:thread.id},replies=>{setReplyCount(replies.length);setLoading(false);});// Cleanup subscription on unmount\nreturn()=>unsubscribe();},[thread===null||thread===void 0?void 0:thread.id]);return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white shadow overflow-hidden sm:rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"px-4 py-5 sm:px-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg leading-6 font-medium text-gray-900\",children:thread.title}),/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800\",children:thread.author_type})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-2 flex items-center text-sm text-gray-500\",children:[/*#__PURE__*/_jsx(User,{className:\"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400\"}),thread.author_name]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-gray-200 px-4 py-5 sm:p-0\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"sm:divide-y sm:divide-gray-200\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\",children:[/*#__PURE__*/_jsx(\"dt\",{className:\"text-sm font-medium text-gray-500\",children:\"Content\"}),/*#__PURE__*/_jsx(\"dd\",{className:\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\",children:thread.content})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\",children:[/*#__PURE__*/_jsx(\"dt\",{className:\"text-sm font-medium text-gray-500\",children:\"Created\"}),/*#__PURE__*/_jsxs(\"dd\",{className:\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(Calendar,{className:\"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400\"}),thread.created_date?format(new Date(thread.created_date),\"MMMM d, yyyy\"):\"N/A\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center mt-1\",children:[/*#__PURE__*/_jsx(Clock,{className:\"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400\"}),thread.created_date?format(new Date(thread.created_date),\"h:mm a\"):\"N/A\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\",children:[/*#__PURE__*/_jsx(\"dt\",{className:\"text-sm font-medium text-gray-500\",children:\"Activity\"}),/*#__PURE__*/_jsx(\"dd\",{className:\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(MessageCircle,{className:\"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400\"}),loading?/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-500\",children:\"Loading...\"}):/*#__PURE__*/_jsxs(\"span\",{children:[replyCount,\" replies\"]})]})})]})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"bg-gray-50 px-4 py-4 sm:px-6\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(Link,{to:\"/MegathreadView?id=\".concat(thread.id),className:\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\",children:\"View Discussion\"})})})]});}","map":{"version":3,"names":["React","useEffect","useState","Link","MessageCircle","User","Calendar","Clock","format","firebaseClient","jsx","_jsx","jsxs","_jsxs","MegathreadCard","_ref","thread","replyCount","setReplyCount","loading","setLoading","id","unsubscribe","entities","ThreadReply","subscribe","megathread_id","replies","length","className","children","title","author_type","author_name","content","created_date","Date","to","concat"],"sources":["/workspace/BigGrade-Main-files/src/components/megathreads/megathreadCard.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { MessageCircle, User, Calendar, Clock } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport firebaseClient from \"@/firebase/firebaseClient\";\n\nexport default function MegathreadCard({ thread }) {\n  const [replyCount, setReplyCount] = useState(0);\n  const [loading, setLoading] = useState(true);\n\n  // Get reply count for this megathread\n  useEffect(() => {\n    if (!thread?.id) return;\n\n    const unsubscribe = firebaseClient.entities.ThreadReply.subscribe(\n      { megathread_id: thread.id },\n      (replies) => {\n        setReplyCount(replies.length);\n        setLoading(false);\n      }\n    );\n\n    // Cleanup subscription on unmount\n    return () => unsubscribe();\n  }, [thread?.id]);\n\n  return (\n    <div className=\"bg-white shadow overflow-hidden sm:rounded-lg\">\n      <div className=\"px-4 py-5 sm:px-6\">\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"text-lg leading-6 font-medium text-gray-900\">\n            {thread.title}\n          </h3>\n          <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800\">\n            {thread.author_type}\n          </span>\n        </div>\n        <div className=\"mt-2 flex items-center text-sm text-gray-500\">\n          <User className=\"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400\" />\n          {thread.author_name}\n        </div>\n      </div>\n      <div className=\"border-t border-gray-200 px-4 py-5 sm:p-0\">\n        <div className=\"sm:divide-y sm:divide-gray-200\">\n          <div className=\"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\">\n            <dt className=\"text-sm font-medium text-gray-500\">Content</dt>\n            <dd className=\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\">\n              {thread.content}\n            </dd>\n          </div>\n          <div className=\"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\">\n            <dt className=\"text-sm font-medium text-gray-500\">Created</dt>\n            <dd className=\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\">\n              <div className=\"flex items-center\">\n                <Calendar className=\"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400\" />\n                {thread.created_date\n                  ? format(new Date(thread.created_date), \"MMMM d, yyyy\")\n                  : \"N/A\"}\n              </div>\n              <div className=\"flex items-center mt-1\">\n                <Clock className=\"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400\" />\n                {thread.created_date\n                  ? format(new Date(thread.created_date), \"h:mm a\")\n                  : \"N/A\"}\n              </div>\n            </dd>\n          </div>\n          <div className=\"py-4 sm:py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6\">\n            <dt className=\"text-sm font-medium text-gray-500\">Activity</dt>\n            <dd className=\"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2\">\n              <div className=\"flex items-center\">\n                <MessageCircle className=\"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400\" />\n                {loading ? (\n                  <span className=\"text-gray-500\">Loading...</span>\n                ) : (\n                  <span>{replyCount} replies</span>\n                )}\n              </div>\n            </dd>\n          </div>\n        </div>\n      </div>\n      <div className=\"bg-gray-50 px-4 py-4 sm:px-6\">\n        <div className=\"flex justify-end\">\n          <Link\n            to={`/MegathreadView?id=${thread.id}`}\n            className=\"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n          >\n            View Discussion\n          </Link>\n        </div>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}